# æ—¥æœŸè¾“å…¥ç»„ä»¶ç»Ÿä¸€æ–¹æ¡ˆ

## ç°çŠ¶åˆ†æ

### ç°æœ‰ç»„ä»¶

| ç»„ä»¶ | æ–‡ä»¶ | åŠŸèƒ½ | ä½¿ç”¨ä½ç½® |
|------|------|------|----------|
| `DateInputField` | `date_input_field.dart` | å¹´-æœˆ-æ—¥è¾“å…¥ + æ—¥å†æŒ‰é’® | `dev_tools_page.dart` |
| `YearMonthInputField` | `year_month_input_field.dart` | å¹´-æœˆè¾“å…¥ï¼ˆæ— æ—¥å†ï¼‰ | `year_month_picker.dart` |
| å†…è”å®ç° | `record_page.dart` | å¹´-æœˆ-æ—¥è¾“å…¥ + æ—¥å†æŒ‰é’® | `record_page.dart` |

### é—®é¢˜

1. **ä»£ç é‡å¤**ï¼š`record_page.dart` ä¸­ç›´æ¥å®ç°äº†æ—¥æœŸè¾“å…¥ï¼Œæ²¡æœ‰å¤ç”¨ `DateInputField`
2. **åŠŸèƒ½é‡å **ï¼š`YearMonthInputField` æœ‰ `showDay` å‚æ•°ä½†æœªå®ç°
3. **ç»´æŠ¤å›°éš¾**ï¼šä¸¤å¥—ç›¸ä¼¼ä»£ç ï¼Œä¿®æ”¹æ—¶å®¹æ˜“é—æ¼

### ç»„ä»¶å¯¹æ¯”

```
DateInputField:          [YYYY] - [MM] - [DD] [ğŸ“…]
YearMonthInputField:     [YYYY] - [MM]
record_page.dartå†…è”:    [YYYY] - [MM] - [DD] [ğŸ“…]
```

## ç»Ÿä¸€æ–¹æ¡ˆ

### æ–¹æ¡ˆé€‰æ‹©

**æ¨èï¼šå¢å¼º `DateInputField`ï¼ŒåºŸå¼ƒ `YearMonthInputField`**

ç†ç”±ï¼š
- `DateInputField` åŠŸèƒ½æœ€å®Œæ•´ï¼Œå·²å®ç°æ—¥å†é€‰æ‹©å™¨
- é€šè¿‡å‚æ•°æ§åˆ¶æ˜¾ç¤ºæ—¥å’Œæ—¥å†æŒ‰é’®å³å¯æ»¡è¶³æ‰€æœ‰åœºæ™¯
- å‡å°‘ç»„ä»¶æ•°é‡ï¼Œé™ä½ç»´æŠ¤æˆæœ¬

### å®ç°æ­¥éª¤

#### 1. å¢å¼º `DateInputField`

æ–°å¢å‚æ•°ï¼š
```dart
class DateInputField extends StatefulWidget {
  // ç°æœ‰å‚æ•°...
  final bool showDay;           // æ˜¯å¦æ˜¾ç¤ºæ—¥è¾“å…¥æ¡†ï¼Œé»˜è®¤ true
  final bool showDatePicker;    // æ˜¯å¦æ˜¾ç¤ºæ—¥å†æŒ‰é’®ï¼Œé»˜è®¤ true

  // ...
}
```

ä½¿ç”¨åœºæ™¯ï¼š
- `showDay=true, showDatePicker=true`ï¼šå®Œæ•´æ—¥æœŸé€‰æ‹©ï¼ˆrecord_page, dev_tools_pageï¼‰
- `showDay=false, showDatePicker=false`ï¼šä»…å¹´æœˆè¾“å…¥ï¼ˆyear_month_pickerï¼‰

#### 2. ä¿®æ”¹ `record_page.dart`

å°†å†…è”çš„æ—¥æœŸè¾“å…¥ä»£ç æ›¿æ¢ä¸º `DateInputField` ç»„ä»¶ã€‚

#### 3. ä¿®æ”¹ `year_month_picker.dart`

å°† `YearMonthInputField` æ›¿æ¢ä¸º `DateInputField(showDay: false, showDatePicker: false)`ã€‚

#### 4. åˆ é™¤ `YearMonthInputField`

ç¡®è®¤æ— å¼•ç”¨ååˆ é™¤è¯¥æ–‡ä»¶ã€‚

## æ–‡ä»¶å˜æ›´æ¸…å•

| æ–‡ä»¶ | æ“ä½œ |
|------|------|
| `widgets/date_input_field.dart` | ä¿®æ”¹ï¼šæ·»åŠ  `showDay` å’Œ `showDatePicker` å‚æ•° |
| `pages/record_page.dart` | ä¿®æ”¹ï¼šä½¿ç”¨ `DateInputField` æ›¿ä»£å†…è”å®ç° |
| `widgets/year_month_picker.dart` | ä¿®æ”¹ï¼šä½¿ç”¨ `DateInputField` æ›¿ä»£ `YearMonthInputField` |
| `widgets/year_month_input_field.dart` | åˆ é™¤ |

## è¯¦ç»†å®ç°

### 1. DateInputField ä¿®æ”¹

```dart
class DateInputField extends StatefulWidget {
  final DateTime initialDate;
  final DateTime? firstDate;
  final DateTime? lastDate;
  final ValueChanged<DateTime>? onChanged;
  final String? label;
  final Color? accentColor;
  final bool showDay;          // æ–°å¢
  final bool showDatePicker;   // æ–°å¢

  const DateInputField({
    super.key,
    required this.initialDate,
    this.firstDate,
    this.lastDate,
    this.onChanged,
    this.label,
    this.accentColor,
    this.showDay = true,
    this.showDatePicker = true,
  });
  // ...
}
```

### 2. record_page.dart ä¿®æ”¹

åˆ é™¤ä»¥ä¸‹å†…å®¹ï¼š
- `_yearController`, `_monthController`, `_dayController`
- `_yearFocus`, `_monthFocus`, `_dayFocus`
- `_onYearFocusChanged`, `_completeYear`, `_onYearChanged` ç­‰æ–¹æ³•
- `_buildDateInputRow()` æ–¹æ³•

æ›¿æ¢ä¸ºï¼š
```dart
DateInputField(
  initialDate: _selectedDate,
  firstDate: DateTime(_minYear),
  lastDate: DateTime(_maxYear, 12, 31),
  onChanged: (date) {
    setState(() {
      _selectedDate = date;
    });
  },
)
```

### 3. year_month_picker.dart ä¿®æ”¹

```dart
DateInputField(
  initialDate: DateTime(_selectedYear, _selectedMonth),
  minYear: _minYear,
  maxYear: _maxYear,
  showDay: false,
  showDatePicker: false,
  onChanged: _onInputChanged,
)
```

## éªŒè¯æ¸…å•

- [ ] `flutter analyze` æ— é”™è¯¯
- [ ] å¼€å‘è€…å·¥å…·é¡µæ—¥æœŸé€‰æ‹©æ­£å¸¸
- [ ] æ‰‹åŠ¨è®°å½•é¡µæ—¥æœŸé€‰æ‹©æ­£å¸¸
- [ ] æ—¥å†å¹´æœˆé€‰æ‹©å™¨è¾“å…¥æ­£å¸¸
- [ ] ä¸¤ä½å¹´ä»½æ ¼å¼åŒ–æ­£å¸¸
